# 物联网设备知识图谱交互管理平台 - 实验二报告

## 02. 子系统A详细设计：设备接入与安全认证

### 1. 子系统概述
子系统A是平台的第一道防线和接入枢纽，专注于设备的连接建立、身份验证和基础通信保障。
**负责人**：吴俊安
**核心职责**：
- 多协议设备接入网关
- 设备身份认证与安全管理
- 安全通信加密
- 连接状态管理

### 2. 静态结构设计 (类图)
本子系统采用面向对象设计，核心类包括`Device`（设备实体）、`AuthenticationService`（认证服务）、`CertificateValidator`（证书验证器）等。

**类图说明：**
- `AuthenticationService` 是核心控制器，负责协调认证流程。
- `CertificateValidator` 封装了具体的证书校验逻辑（如X.509）。
- `AuditLogger` 负责记录所有的认证尝试和结果，满足审计需求。

![子系统A类图](./diagrams/class_diagram_A.mmd)

### 3. 动态行为设计

#### 3.1 顺序图 (Sequence Diagram) - 设备身份认证 (UC-A-002)
该顺序图描述了设备发起连接请求到认证成功/失败的完整交互过程。

**流程描述：**
1. 设备向网关发送携带证书的连接请求。
2. 网关将请求转发给认证服务。
3. 认证服务调用证书验证器校验确保证书合法。
4. 验证通过后，查询数据库确认设备已注册。
5. 生成访问令牌（Access Token）并返回给设备，建立会话。

![设备身份认证顺序图](./diagrams/sequence_diagram_A_auth.mmd)

#### 3.2 状态图 (State Diagram) - 设备连接状态
该状态图描述了设备在接入过程中的状态流转，包括未连接、连接中、认证中、在线等状态。

**状态说明：**
- **Disconnected**: 初始状态，设备未连接。
- **Authenticating**: 设备正在进行身份验证。
- **Online**: 认证成功，建立会话，可以传输数据。
- **Reauthenticating**: 令牌过期，尝试刷新令牌。

![设备连接状态图](./diagrams/state_diagram_A_device.mmd)

#### 3.3 活动图 (Activity Diagram) - 设备身份认证流程
该活动图描述了认证过程中的控制流和分支判断。

![设备身份认证活动图](./diagrams/activity_diagram_A_auth.mmd)

### 5. 用户接口/界面原型设计

#### 5.1 界面交互流程
设备接入与认证主要涉及后台管理界面和设备端交互。
1. **设备注册**：管理员在“设备管理”界面录入设备信息，生成证书/密钥。
2. **连接状态**：管理员在“仪表盘”或“设备列表”查看设备实时在线状态。

#### 5.2 界面原型引用
- **设备注册页**：管理员录入新设备信息。
  - 原型文件：[ui/device_register.html](../ui/device_register.html)
- **设备列表页**：展示设备在线/离线状态。
  - 原型文件：[ui/device_list.html](../ui/device_list.html)
- **登录页**：管理员登录入口。
  - 原型文件：[ui/login.html](../ui/login.html)

---
*下一部分：子系统B详细设计*
